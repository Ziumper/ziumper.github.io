<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom" xml:lang="en"><generator uri="https://jekyllrb.com/" version="4.3.4">Jekyll</generator><link href="https://ziumper.github.io/pl/feed.xml" rel="self" type="application/atom+xml"/><link href="https://ziumper.github.io/pl/" rel="alternate" type="text/html" hreflang="en"/><updated>2025-10-08T18:42:38+00:00</updated><id>https://ziumper.github.io/feed.xml</id><title type="html">Ziumper</title><entry><title type="html">Przecinek po nowej linii w argumentach funkcji PHP (trailing comma)</title><link href="https://ziumper.github.io/pl/blog/2025/trailing-comma-line/" rel="alternate" type="text/html" title="Przecinek po nowej linii w argumentach funkcji PHP (trailing comma)"/><published>2025-10-07T00:00:00+00:00</published><updated>2025-10-07T00:00:00+00:00</updated><id>https://ziumper.github.io/blog/2025/trailing-comma-line</id><content type="html" xml:base="https://ziumper.github.io/blog/2025/trailing-comma-line/"><![CDATA[<p>Czy zdarzyÅ‚o Ci siÄ™ kiedyÅ› dodaÄ‡ nowy argument do funkcji lub konstruktora w PHP i zapomnieÄ‡ o przecinku na koÅ„cu poprzedniej linii? To czÄ™sty bÅ‚Ä…d, ktÃ³ry moÅ¼e prowadziÄ‡ do niepotrzebnych poprawek i frustracji.</p> <p>Na szczÄ™Å›cie od PHP 7.3 moÅ¼esz uÅ¼ywaÄ‡ tzw. trailing comma, czyli przecinka po ostatnim argumencie w wywoÅ‚aniach funkcji, deklaracjach funkcji oraz w tablicach. DziÄ™ki temu, gdy dodajesz nowy argument, nie musisz pamiÄ™taÄ‡ o rÄ™cznym dodaniu przecinka na koÅ„cu poprzedniej linii.</p> <h3 id="-przykÅ‚ad-bez-trailing-comma">ğŸ›‘ PrzykÅ‚ad bez trailing comma</h3> <div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">class</span> <span class="nc">User</span> <span class="p">{</span>
    <span class="k">public</span> <span class="k">function</span> <span class="n">__construct</span><span class="p">(</span>
        <span class="kt">string</span> <span class="nv">$name</span><span class="p">,</span>
        <span class="kt">int</span> <span class="nv">$age</span>
    <span class="p">)</span> <span class="p">{</span>
        <span class="c1">// ...</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div> <p>JeÅ›li chcesz dodaÄ‡ kolejny argument, musisz wrÃ³ciÄ‡ do poprzedniej linii i dodaÄ‡ przecinek:</p> <div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">class</span> <span class="nc">User</span> <span class="p">{</span>
    <span class="k">public</span> <span class="k">function</span> <span class="n">__construct</span><span class="p">(</span>
        <span class="kt">string</span> <span class="nv">$name</span><span class="p">,</span>
        <span class="kt">int</span> <span class="nv">$age</span><span class="p">,</span> <span class="c1">// musisz dodaÄ‡ przecinek</span>
        <span class="kt">string</span> <span class="nv">$email</span>
    <span class="p">)</span> <span class="p">{</span>
        <span class="c1">// ...</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div> <h3 id="-przykÅ‚ad-z-trailing-comma">âœ… PrzykÅ‚ad z trailing comma</h3> <div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">class</span> <span class="nc">User</span> <span class="p">{</span>
    <span class="k">public</span> <span class="k">function</span> <span class="n">__construct</span><span class="p">(</span>
        <span class="kt">string</span> <span class="nv">$name</span><span class="p">,</span>
        <span class="kt">int</span> <span class="nv">$age</span><span class="p">,</span>
    <span class="p">)</span> <span class="p">{</span>
        <span class="c1">// ...</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div> <p>Teraz moÅ¼esz po prostu dopisaÄ‡ kolejny argument bez martwienia siÄ™ o przecinki:</p> <div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">class</span> <span class="nc">User</span> <span class="p">{</span>
    <span class="k">public</span> <span class="k">function</span> <span class="n">__construct</span><span class="p">(</span>
        <span class="kt">string</span> <span class="nv">$name</span><span class="p">,</span>
        <span class="kt">int</span> <span class="nv">$age</span><span class="p">,</span>
        <span class="kt">string</span> <span class="nv">$email</span><span class="p">,</span>
    <span class="p">)</span> <span class="p">{</span>
        <span class="c1">// ...</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div> <h3 id="-od-kiedy">ğŸ“… Od kiedy?</h3> <p>Trailing comma w listach argumentÃ³w funkcji i metod jest dostÄ™pny od PHP 7.3. WczeÅ›niej moÅ¼na byÅ‚o jej uÅ¼ywaÄ‡ tylko w tablicach.</p> <h3 id="-podsumowanie">ğŸ“ Podsumowanie</h3> <p>Stosowanie trailing comma:</p> <ul> <li>uÅ‚atwia dodawanie i usuwanie argumentÃ³w,</li> <li>zmniejsza ryzyko bÅ‚Ä™dÃ³w skÅ‚adniowych,</li> <li>poprawia czytelnoÅ›Ä‡ kodu w dÅ‚uÅ¼szej perspektywie.</li> </ul> <p>Warto korzystaÄ‡ z tej moÅ¼liwoÅ›ci, szczegÃ³lnie w wiÄ™kszych projektach!</p>]]></content><author><name></name></author><category term="php"/><summary type="html"><![CDATA[Jak trailing comma (,) w PHP uÅ‚atwia Å¼ycie programisty przy pracy z argumentami funkcji i konstruktorÃ³w.,]]></summary></entry><entry><title type="html">Wykorzystanie array_map() w codziennym Å¼yciu programisty. PrzeglÄ…d PHP #7</title><link href="https://ziumper.github.io/pl/blog/2025/array-map-in-php/" rel="alternate" type="text/html" title="Wykorzystanie array_map() w codziennym Å¼yciu programisty. PrzeglÄ…d PHP #7"/><published>2025-09-30T00:00:00+00:00</published><updated>2025-09-30T00:00:00+00:00</updated><id>https://ziumper.github.io/blog/2025/array-map-in-php</id><content type="html" xml:base="https://ziumper.github.io/blog/2025/array-map-in-php/"><![CDATA[<p>ArtykuÅ‚ nie bÄ™dzie zbyt dÅ‚ugi, ale na pewno bÄ™dzie na tyle uÅ¼yteczny, Å¼e moÅ¼e komuÅ› posÅ‚uÅ¼yÄ‡ jako dobry odnoÅ›nik do przyszÅ‚ych decyzji. Czy warto uÅ¼yÄ‡ <code class="language-plaintext highlighter-rouge">array_map</code>? Zdecydowanie tak, jeÅ¼eli musimy wykonaÄ‡ pewne operacje mutacji na poszczegÃ³lnych elementach. MoÅ¼e to byÄ‡ na przykÅ‚ad:</p> <ul> <li>budowanie podtablic z rÃ³znych wartoÅ›ci</li> </ul> <div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">php</span> <span class="o">&gt;</span> <span class="nb">var_dump</span><span class="p">(</span><span class="nb">array_map</span><span class="p">(</span><span class="k">static</span> <span class="k">fn</span> <span class="p">(</span><span class="nv">$value</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'numeric_string'</span> <span class="o">=&gt;</span> <span class="nv">$value</span><span class="p">],</span> <span class="p">[</span><span class="s1">'zero'</span><span class="p">,</span><span class="s1">'one'</span><span class="p">,</span><span class="s1">'two'</span><span class="p">,</span><span class="s1">'three'</span><span class="p">]));</span>
<span class="k">array</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="p">{</span>
  <span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">=&gt;</span>
  <span class="k">array</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
    <span class="p">[</span><span class="s2">"numeric_string"</span><span class="p">]</span><span class="o">=&gt;</span>
    <span class="nf">string</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="s2">"zero"</span>
  <span class="p">}</span>
  <span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">=&gt;</span>
  <span class="k">array</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
    <span class="p">[</span><span class="s2">"numeric_string"</span><span class="p">]</span><span class="o">=&gt;</span>
    <span class="nf">string</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="s2">"one"</span>
  <span class="p">}</span>
  <span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">=&gt;</span>
  <span class="k">array</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
    <span class="p">[</span><span class="s2">"numeric_string"</span><span class="p">]</span><span class="o">=&gt;</span>
    <span class="nf">string</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="s2">"two"</span>
  <span class="p">}</span>
  <span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">=&gt;</span>
  <span class="k">array</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
    <span class="p">[</span><span class="s2">"numeric_string"</span><span class="p">]</span><span class="o">=&gt;</span>
    <span class="nf">string</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="s2">"three"</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div> <ul> <li>wyciÄ…gniÄ™cie wartoÅ›ci innej tablicy i zamiana jÄ… na innÄ…</li> </ul> <div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ids</span> <span class="o">=</span> <span class="nb">array_map</span><span class="p">(</span><span class="k">static</span> <span class="k">fn</span> <span class="p">(</span><span class="nv">$id</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'id'</span> <span class="o">=&gt;</span> <span class="nv">$id</span><span class="p">],</span> <span class="nb">array_values</span><span class="p">(</span><span class="nv">$ids</span><span class="p">));</span>
</code></pre></div></div> <ul> <li>zwrÃ³cenie nowej listy wartoÅ›ci ze zmienionnymi wartoÅ›ciami, nie zmieniajÄ…c starej listy</li> </ul> <div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$newArray</span> <span class="o">=</span> <span class="nb">array_map</span><span class="p">(</span><span class="k">static</span> <span class="k">fn</span> <span class="p">(</span><span class="nv">$item</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nb">str_replace</span><span class="p">(</span><span class="s1">'"'</span><span class="mf">.</span><span class="s1">'""'</span><span class="mf">.</span><span class="nv">$item</span><span class="p">);</span>
</code></pre></div></div> <p>PrzykÅ‚ady moÅ¼na mnoÅ¼yÄ‡, ale najwiÄ™cej uÅ¼ytecznych przykÅ‚adÃ³w moÅ¼na znaleÅºÄ‡ tu: <a href="https://www.php.net/manual/en/function.array-map.php">link do dokumentacji PHP</a></p>]]></content><author><name></name></author><category term="php"/><summary type="html"><![CDATA[Tym razem postanowiÅ‚em przyjrzeÄ‡ siÄ™ najczÄ™stszym wykorzystaniom array_map w moim codziennym kodzie.]]></summary></entry><entry><title type="html">W koÅ„cu dobrze napisane testy z odpowiedniÄ… strukturÄ… Å‚adowania Composer</title><link href="https://ziumper.github.io/pl/blog/2025/Composer-with-phpunit-setup/" rel="alternate" type="text/html" title="W koÅ„cu dobrze napisane testy z odpowiedniÄ… strukturÄ… Å‚adowania Composer"/><published>2025-09-29T00:00:00+00:00</published><updated>2025-09-29T00:00:00+00:00</updated><id>https://ziumper.github.io/blog/2025/Composer-with-phpunit-setup</id><content type="html" xml:base="https://ziumper.github.io/blog/2025/Composer-with-phpunit-setup/"><![CDATA[<p>PotykaÅ‚em siÄ™, czoÅ‚gaÅ‚em po ziemi, majÄ…c Åºle skonfigurowany projekt, nad ktÃ³rym powinienem byÅ‚ pracowaÄ‡. I wtedy zrozumiaÅ‚em, jak powinienem uporzÄ…dkowaÄ‡ sposÃ³b Å‚adowania klas.</p> <p>Oto, co miaÅ‚em wczeÅ›niej w moim projekcie:</p> <div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"autoload"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nl">"psr-4"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nl">"Ziumper\\App\\"</span><span class="p">:</span><span class="w"> </span><span class="s2">"src/"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"Ziumper\\App\\"</span><span class="p">:</span><span class="w"> </span><span class="s2">"tests/"</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div> <p>Ale w ten sposÃ³b wszystkie moje klasy byÅ‚y Å‚adowane do mapy autoload Composera. WiedziaÅ‚em, Å¼e musi byÄ‡ na to lepszy sposÃ³b. I oto co odkryÅ‚em:</p> <div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"autoload"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nl">"psr-4"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nl">"Ziumper\\App\\"</span><span class="p">:</span><span class="w"> </span><span class="s2">"src/"</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="nl">"autoload-dev"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nl">"psr-4"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nl">"Ziumper\\App\\"</span><span class="p">:</span><span class="w"> </span><span class="s2">"tests/"</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div> <p>W miÄ™dzyczasie napotkaÅ‚em kilka powaÅ¼nych problemÃ³w â€” nie mogÅ‚em zadeklarowaÄ‡ TraitÃ³w w folderze testÃ³w, a kopiowanie i wklejanie caÅ‚ego tego kodu byÅ‚o bardzo frustrujÄ…ce. W koÅ„cu przeszedÅ‚em do kolejnej wersji:</p> <div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"autoload"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nl">"psr-4"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nl">"Ziumper\\App\\"</span><span class="p">:</span><span class="w"> </span><span class="s2">"src/"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nl">"exclude-from-classmap"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"tests/"</span><span class="p">]</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="nl">"autoload-dev"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nl">"psr-4"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nl">"Ziumper\\App\\Tests\\Unit\\"</span><span class="p">:</span><span class="w"> </span><span class="s2">"tests/unit"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"Ziumper\\App\\Tests\\Integration\\"</span><span class="p">:</span><span class="w"> </span><span class="s2">"tests/integration"</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div> <p>Jak to dziaÅ‚a:</p> <ul> <li>wszystkie deklaracje przechowywane sÄ… w folderze src, nawet te uÅ¼ywane w testach â€” np. bazowe przypadki testowe, traitâ€™y, data providery itd.,</li> <li>testy integracyjne i jednostkowe korzystajÄ… z odniesieÅ„ do src i wszystko dziaÅ‚a bardzo sprawnie,</li> <li><code class="language-plaintext highlighter-rouge">exclude-from-classmap</code> to coÅ› w rodzaju straÅ¼nika, ktÃ³ry pilnuje, aby kod testowy nie zostaÅ‚ przypadkowo zaÅ‚adowany do produkcyjnego Å›rodowiska.</li> </ul> <p>MyÅ›lÄ™, Å¼e w ten sposÃ³b mogÄ™ w koÅ„cu zaczÄ…Ä‡ budowaÄ‡ coÅ›â€¦ co naprawdÄ™ ma sens!</p>]]></content><author><name></name></author><category term="php"/><category term="composer"/><category term="phpunit"/><summary type="html"><![CDATA[Ten wpis wyjaÅ›nia, jak zorganizowaÄ‡ projekt oparty na Composerze z zaleÅ¼noÅ›ciami PHPUnit, aby nie Å‚adowaÄ‡ przypadkÃ³w testowych do classmapy, oraz opisuje wnioski, ktÃ³re wyciÄ…gnÄ…Å‚em w trakcie pracy.]]></summary></entry><entry><title type="html">Jak zintegrowaÄ‡ GitHub Copilot do automatycznego generowania wiadomoÅ›ci commitÃ³w?</title><link href="https://ziumper.github.io/pl/blog/2025/Add-github-copilot-auto-commit-message-generation/" rel="alternate" type="text/html" title="Jak zintegrowaÄ‡ GitHub Copilot do automatycznego generowania wiadomoÅ›ci commitÃ³w?"/><published>2025-09-24T00:00:00+00:00</published><updated>2025-09-24T00:00:00+00:00</updated><id>https://ziumper.github.io/blog/2025/Add-github-copilot-auto-commit-message-generation</id><content type="html" xml:base="https://ziumper.github.io/blog/2025/Add-github-copilot-auto-commit-message-generation/"><![CDATA[<p>NajwaÅ¼niejszÄ… czÄ™Å›ciÄ… pracy w zespole jest komunikacja. Jednym z najwaÅ¼niejszych sposobÃ³w komunikacji z zespoÅ‚em sÄ… wiadomoÅ›ci commitÃ³w. Dobra wiadomoÅ›Ä‡ commita powinna byÄ‡ jasna, zwiÄ™zÅ‚a i informatywna. Powinna opisywaÄ‡, jakie zmiany zostaÅ‚y wprowadzone i dlaczego. Jednak pisanie dobrych wiadomoÅ›ci commitÃ³w moÅ¼e byÄ‡ czasochÅ‚onne i nuÅ¼Ä…ce. Tu z pomocÄ… przychodzi GitHub Copilot. GitHub Copilot to narzÄ™dzie wspierane przez AI, ktÃ³re pomaga pisaÄ‡ kod szybciej i efektywniej. Ale czy wiesz, Å¼e GitHub Copilot moÅ¼e takÅ¼e pomÃ³c w pisaniu lepszych wiadomoÅ›ci commitÃ³w? W tym wpisie pokaÅ¼emy, jak uÅ¼ywaÄ‡ GitHub Copilot do automatycznego generowania wiadomoÅ›ci commitÃ³w.</p> <h2 id="krok-1-dodaj-szablon-github-copilot-do-swojego-repozytorium">Krok 1: Dodaj szablon GitHub Copilot do swojego repozytorium</h2> <p>Aby rozpoczÄ…Ä‡, musisz dodaÄ‡ szablon GitHub Copilot do swojego repozytorium. Ten szablon zapewni GitHub Copilot odpowiedni kontekst do generowania wiadomoÅ›ci commitÃ³w. MoÅ¼esz utworzyÄ‡ nowy plik w repozytorium o nazwie <code class="language-plaintext highlighter-rouge">.github/git-commit-instructions.md</code> i dodaÄ‡ nastÄ™pujÄ…cÄ… zawartoÅ›Ä‡:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code># Git Commit Instructions

When making a commit, please follow these guidelines to ensure clarity and consistency in our commit history.
Provide description in the commit message.
* Describe the changes made in the commit and intended impact on the codebase in new lines.
* Make sure to include:
    * What was changed (e.g., added feature, fixed bug, updated documentation).
    * Why the change was necessary (e.g., to improve performance, fix an issue, enhance user experience).
    * Any relevant details that help understand the context of the change.
* Elaborate on the reasoning behind the changes and any relevant context that may help reviewers understand the
commit better.
</code></pre></div></div> <p>Ten szablon zawiera wytyczne dotyczÄ…ce pisania dobrych wiadomoÅ›ci commitÃ³w i pomoÅ¼e GitHub Copilot generowaÄ‡ lepsze wiadomoÅ›ci.</p> <h2 id="krok-2-uÅ¼yj-github-copilot-do-generowania-wiadomoÅ›ci-commitÃ³w">Krok 2: UÅ¼yj GitHub Copilot do generowania wiadomoÅ›ci commitÃ³w</h2> <p>Po dodaniu szablonu do repozytorium moÅ¼esz zaczÄ…Ä‡ uÅ¼ywaÄ‡ GitHub Copilot do generowania wiadomoÅ›ci commitÃ³w. Gdy bÄ™dziesz gotowy do wykonania commita, moÅ¼esz uÅ¼yÄ‡ jednego z poniÅ¼szych edytorÃ³w IDE wspierajÄ…cych GitHub Copilot:</p> <ul> <li>Visual Studio Code</li> <li>IDE JetBrains (np. IntelliJ IDEA, PyCharm, WebStorm)</li> <li>Neovim Po otwarciu edytora wiadomoÅ›ci commita GitHub Copilot automatycznie zaproponuje wiadomoÅ›Ä‡ commita na podstawie wprowadzonych zmian oraz wytycznych ze wskazanego szablonu. GitHub Copilot automatycznie zasugeruje wiadomoÅ›Ä‡ commita na podstawie wprowadzonych zmian oraz wytycznych ze wskazanego szablonu.</li> </ul> <h2 id="podsumowanie">Podsumowanie</h2> <p>Korzystanie z GitHub Copilot do automatycznego generowania wiadomoÅ›ci commitÃ³w moÅ¼e pomÃ³c pisaÄ‡ lepsze wiadomoÅ›ci i zwiÄ™kszyÄ‡ produktywnoÅ›Ä‡. DodajÄ…c szablon GitHub Copilot do repozytorium i korzystajÄ…c z jednego z obsÅ‚ugiwanych edytorÃ³w IDE wspierajÄ…cych GitHub Copilot, moÅ¼esz Å‚atwo generowaÄ‡ przejrzyste i informatywne wiadomoÅ›ci commitÃ³w. SprÃ³buj i zobacz, jak moÅ¼e to usprawniÄ‡ TwÃ³j workflow! Ja juÅ¼ korzystam i bardzo polecam! ğŸ˜Š</p>]]></content><author><name></name></author><category term="git"/><category term="github"/><category term="productivity"/><category term="copilot"/><summary type="html"><![CDATA[Ten post wyjaÅ›nia, jak uÅ¼ywaÄ‡ GitHub Copilot do automatycznego generowania wiadomoÅ›ci commitÃ³w, zwiÄ™kszajÄ…c produktywnoÅ›Ä‡ i zapewniajÄ…c przejrzystÄ… historiÄ™ zmian.]]></summary></entry><entry><title type="html">ğŸ¤“ Dlaczego programiÅ›ci PHP kochajÄ… pustÄ… liniÄ™ na koÅ„cu pliku? PrzeglÄ…d PHP #6</title><link href="https://ziumper.github.io/pl/blog/2025/New-line-at-the-end-of-php-file/" rel="alternate" type="text/html" title="ğŸ¤“ Dlaczego programiÅ›ci PHP kochajÄ… pustÄ… liniÄ™ na koÅ„cu pliku? PrzeglÄ…d PHP #6"/><published>2025-09-23T00:00:00+00:00</published><updated>2025-09-23T00:00:00+00:00</updated><id>https://ziumper.github.io/blog/2025/New-line-at-the-end-of-php-file</id><content type="html" xml:base="https://ziumper.github.io/blog/2025/New-line-at-the-end-of-php-file/"><![CDATA[<h1 id="dlaczego-dodaje-siÄ™-pustÄ…-liniÄ™-na-koÅ„cu-plikÃ³w-php-i-twig-">Dlaczego dodaje siÄ™ pustÄ… liniÄ™ na koÅ„cu plikÃ³w PHP i Twig? ğŸ¤”</h1> <p>Czy kiedykolwiek zastanawiaÅ‚eÅ› siÄ™, dlaczego programiÅ›ci z uporem maniaka dodajÄ… pustÄ… liniÄ™ na koÅ„cu plikÃ³w? Czy to jakaÅ› tajna tradycja? A moÅ¼e sposÃ³b na walkÄ™ z nudÄ…? OdpowiedÅº jest bardziej techniczna, ale nie brakuje tu odrobiny historii iâ€¦ odrobiny absurdu! ğŸ˜„</p> <h2 id="powody-techniczne-ï¸">Powody techniczne ğŸ› ï¸</h2> <h3 id="1-standard-posix-">1. <strong>Standard POSIX</strong> ğŸ§‘â€ğŸ’»</h3> <p>WyobraÅº sobie, Å¼e POSIX to taki surowy nauczyciel w szkole programistÃ³w. MÃ³wi: â€œKaÅ¼dy plik tekstowy musi koÅ„czyÄ‡ siÄ™ nowÄ… liniÄ… (<code class="language-plaintext highlighter-rouge">\n</code>). Koniec dyskusji!â€ Dlaczego? Bo narzÄ™dzia takie jak <code class="language-plaintext highlighter-rouge">cat</code>, <code class="language-plaintext highlighter-rouge">diff</code> czy <code class="language-plaintext highlighter-rouge">git</code> lubiÄ… porzÄ…dek. JeÅ›li plik nie koÅ„czy siÄ™ nowÄ… liniÄ…, mogÄ… siÄ™ obraziÄ‡ i pokazaÄ‡ dziwne wyniki, np. poÅ‚Ä…czÄ… ostatniÄ… liniÄ™ jednego pliku z pierwszÄ… drugiego. To trochÄ™ jakby dwa zdania w ksiÄ…Å¼ce zlaÅ‚y siÄ™ w jedno â€“ chaos! ğŸ“š</p> <p>POSIX (Portable Operating System Interface) powstaÅ‚, by ujednoliciÄ‡ zachowanie systemÃ³w operacyjnych. DziÄ™ki temu programy mogÄ… dziaÅ‚aÄ‡ przewidywalnie na rÃ³Å¼nych komputerach. A pusta linia na koÅ„cu pliku to taki maÅ‚y gest w stronÄ™ porzÄ…dku i kompatybilnoÅ›ci. âœ¨</p> <h3 id="2-unikanie-bÅ‚Ä™dÃ³w-w-php-">2. <strong>Unikanie bÅ‚Ä™dÃ³w w PHP</strong> ğŸ˜</h3> <p>W PHP, jeÅ›li po zamkniÄ™ciu tagu <code class="language-plaintext highlighter-rouge">?&gt;</code> pojawi siÄ™ cokolwiek â€“ nawet niewinna spacja czy nowa linia â€“ serwer moÅ¼e siÄ™ zdenerwowaÄ‡ i wysÅ‚aÄ‡ nagÅ‚Ã³wki HTTP w zÅ‚ym momencie. Efekt? Strona wyglÄ…da dziwnie, a Ty szukasz bÅ‚Ä™du przez pÃ³Å‚ dnia. Pusta linia to taki programistyczny amulet na szczÄ™Å›cie! ğŸ€</p> <h3 id="3-lepsza-czytelnoÅ›Ä‡-">3. <strong>Lepsza czytelnoÅ›Ä‡</strong> ğŸ‘€</h3> <p>Pusta linia na koÅ„cu pliku to jak kropka na koÅ„cu zdania. DziÄ™ki niej kod wyglÄ…da schludnie, a zmiany w systemach kontroli wersji sÄ… bardziej przejrzyste. Git lubi, gdy wszystko jest na swoim miejscu! ğŸ˜</p> <h3 id="4-standardy-psr-2-i-psr-12-">4. <strong>Standardy PSR-2 i PSR-12</strong> ğŸ“</h3> <p>A co na to PHP-FIG, czyli programistyczna rada starszych? WymyÅ›lili standard PSR-2, a potem jego mÅ‚odszego, bardziej wymagajÄ…cego brata PSR-12. Oba mÃ³wiÄ… jasno: na koÅ„cu pliku ma byÄ‡ nowa linia! DziÄ™ki temu kod jest zgodny z wytycznymi, a TwÃ³j linter nie dostaje ataku paniki. To trochÄ™ jak przestrzeganie zasad BHP w kodzie â€“ nikt nie chce dostaÄ‡ mandatu od reviewera! ğŸš¨</p> <h2 id="powody-historyczne-">Powody historyczne ğŸº</h2> <p>Dawniej edytory tekstu byÅ‚y kapryÅ›ne. Brak pustej linii mÃ³gÅ‚ wywoÅ‚aÄ‡ bÅ‚Ä™dy przy kompilacji lub interpretacji kodu. ProgramiÅ›ci nauczyli siÄ™ wiÄ™c dodawaÄ‡ tÄ™ magicznÄ… liniÄ™, by uniknÄ…Ä‡ niespodzianek. To trochÄ™ jak noszenie skarpetek do sandaÅ‚Ã³w â€“ nie zawsze potrzebne i jest traktowane jako bezguÅ›cie, ale czasem ratuje dzieÅ„! ğŸ§¦</p> <h2 id="twig-ï¸">Twig ğŸ•¸ï¸</h2> <p>W plikach Twig pusta linia pomaga uniknÄ…Ä‡ niechcianych znakÃ³w w generowanym HTML. DziÄ™ki temu Twoja strona nie wyglÄ…da jak patchwork z przypadkowych spacji i enterÃ³w. A systemy kontroli wersji? One teÅ¼ sÄ… wdziÄ™czne! ğŸ™</p> <h2 id="podsumowanie-">Podsumowanie ğŸ‰</h2> <p>Dodawanie pustej linii na koÅ„cu plikÃ³w PHP i Twig to nie tylko techniczna koniecznoÅ›Ä‡, ale teÅ¼ element programistycznej kultury. Chroni przed bÅ‚Ä™dami, dba o porzÄ…dek i sprawia, Å¼e narzÄ™dzia sÄ… szczÄ™Å›liwe. WiÄ™c nastÄ™pnym razem, gdy dodasz pustÄ… liniÄ™, moÅ¼esz poczuÄ‡ siÄ™ jak bohater kodu! ğŸ¦¸â€â™‚ï¸</p>]]></content><author><name></name></author><category term="php"/><summary type="html"><![CDATA[Post wyjaÅ›nia, dlaczego programiÅ›ci dodajÄ… pustÄ… liniÄ™ na koÅ„cu plikÃ³w PHP i Twig, przedstawiajÄ…c techniczne, historyczne oraz humorystyczne powody tej praktyki. Dowiesz siÄ™, jak wpÅ‚ywa to na kompatybilnoÅ›Ä‡, czytelnoÅ›Ä‡ kodu i unikniÄ™cie bÅ‚Ä™dÃ³w]]></summary></entry><entry><title type="html">ğŸ§¹ Jak usunÄ…Ä‡ przepisy z sekcji `extra` w composer.json</title><link href="https://ziumper.github.io/pl/blog/2025/Composer-recipes-fix/" rel="alternate" type="text/html" title="ğŸ§¹ Jak usunÄ…Ä‡ przepisy z sekcji `extra` w composer.json"/><published>2025-09-22T00:00:00+00:00</published><updated>2025-09-22T00:00:00+00:00</updated><id>https://ziumper.github.io/blog/2025/Composer-recipes-fix</id><content type="html" xml:base="https://ziumper.github.io/blog/2025/Composer-recipes-fix/"><![CDATA[<p>PracujÄ…c nad projektami PHP, szczegÃ³lnie tymi opartymi o Symfony, moÅ¼esz natrafiÄ‡ na sekcjÄ™ <code class="language-plaintext highlighter-rouge">extra</code> w pliku <code class="language-plaintext highlighter-rouge">composer.json</code>. CzÄ™sto zawiera ona przepisy (recipes), ktÃ³re pomagajÄ… skonfigurowaÄ‡ TwÃ³j projekt. Z czasem moÅ¼esz jednak zechcieÄ‡ usunÄ…Ä‡ lub uporzÄ…dkowaÄ‡ te przepisy.</p> <h2 id="czym-jest-sekcja-extra-w-composerjson">Czym jest sekcja <code class="language-plaintext highlighter-rouge">extra</code> w composer.json?</h2> <p>Sekcja <code class="language-plaintext highlighter-rouge">extra</code> to specjalne miejsce w pliku <code class="language-plaintext highlighter-rouge">composer.json</code> na niestandardowÄ… konfiguracjÄ™.<br/> UÅ¼ywana jest przez wtyczki Composera, frameworki (np. Symfony), czy skrypty do przechowywania dodatkowych ustawieÅ„.</p> <h3 id="przykÅ‚ad">PrzykÅ‚ad</h3> <div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"extra"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nl">"symfony"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nl">"allow-contrib"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
      </span><span class="nl">"recipes"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nl">"symfony/console"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="nl">"version"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1.0"</span><span class="p">,</span><span class="w">
          </span><span class="nl">"ref"</span><span class="p">:</span><span class="w"> </span><span class="s2">"abcdef"</span><span class="w">
        </span><span class="p">}</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div> <h2 id="do-czego-uÅ¼ywaÅ‚em-sekcji-extra">Do czego uÅ¼ywaÅ‚em sekcji <code class="language-plaintext highlighter-rouge">extra</code>?</h2> <p>Ja wykorzystywaÅ‚em jÄ… do przechowywania przepisÃ³w Symfony Flex. Symfony Flex to wtyczka Composera, ktÃ³ra pomaga zarzÄ…dzaÄ‡ aplikacjami Symfony poprzez automatycznÄ… instalacjÄ™ i konfiguracjÄ™ pakietÃ³w. Gdy instalujesz pakiet posiadajÄ…cy przepis, Symfony Flex dodaje pliki konfiguracyjne i ustawienia do projektu automatycznie. MoÅ¼esz chcieÄ‡ usunÄ…Ä‡ niektÃ³re z tych przepisÃ³w, jeÅ›li nie sÄ… Ci juÅ¼ potrzebne lub chcesz dostosowaÄ‡ swojÄ… konfiguracjÄ™. W moim przypadku byÅ‚a to konfiguracja dockera, ktÃ³rej nie potrzebowaÅ‚em.</p> <div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"extra"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nl">"symfony"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nl">"allow-contrib"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
      </span><span class="nl">"docker"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div> <h2 id="symfony-flex">Symfony Flex</h2> <p>Przepisy Flex przyjmujÄ… pewne zaÅ‚oÅ¼enia co do struktury katalogÃ³w w Twoim projekcie. CzÄ™Å›Ä‡ z tych zaÅ‚oÅ¼eÅ„ moÅ¼na dostosowaÄ‡, dodajÄ…c odpowiedni klucz w sekcji extra w pliku composer.json. PrzykÅ‚adowo, aby powiedzieÄ‡ Flexowi, by kopiowaÅ‚ klasy PHP do src/App zamiast src:</p> <div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"..."</span><span class="p">:</span><span class="w"> </span><span class="s2">"..."</span><span class="p">,</span><span class="w">

  </span><span class="nl">"extra"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nl">"src-dir"</span><span class="p">:</span><span class="w"> </span><span class="s2">"src/App"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div> <h2 id="rozwiÄ…zywanie-problemÃ³w">RozwiÄ…zywanie problemÃ³w</h2> <p>JeÅ›li napotkasz problemy po usuniÄ™ciu przepisÃ³w, sprÃ³buj wykonaÄ‡ poniÅ¼sze kroki:</p> <ul> <li>Uruchom <code class="language-plaintext highlighter-rouge">composer install</code>, aby odÅ›wieÅ¼yÄ‡ zaleÅ¼noÅ›ci.</li> <li>SprawdÅº, czy nie brakuje plikÃ³w konfiguracyjnych lub zmiennych Å›rodowiskowych.</li> <li>Przejrzyj dokumentacjÄ™ Symfony, aby sprawdziÄ‡, czy po usuniÄ™ciu przepisu wymagane sÄ… dodatkowe rÄ™czne kroki.</li> </ul> <h2 id="dodatkowe-zasoby">Dodatkowe zasoby</h2> <ul> <li><a href="https://symfony.com/doc/current/setup/flex.html">Dokumentacja przepisÃ³w Symfony</a></li> <li><a href="https://getcomposer.org/doc/04-schema.md#extra">Sekcja Extra w Composer</a></li> </ul>]]></content><author><name></name></author><category term="php,"/><category term="composer,"/><category term="symfony,"/><category term="symfony-flex"/><summary type="html"><![CDATA[KrÃ³tki przewodnik po sekcji `extra` w composer.json oraz usuwaniu przepisÃ³w Symfony.]]></summary></entry><entry><title type="html">ğŸ§ PHP, Liczby zmiennoprzecinkowe i Tajemnica -0.0 PrzeglÄ…d PHP #5</title><link href="https://ziumper.github.io/pl/blog/2025/Floats-and-mystery-of-zero/" rel="alternate" type="text/html" title="ğŸ§ PHP, Liczby zmiennoprzecinkowe i Tajemnica -0.0 PrzeglÄ…d PHP #5"/><published>2025-09-18T00:00:00+00:00</published><updated>2025-09-18T00:00:00+00:00</updated><id>https://ziumper.github.io/blog/2025/Floats-and-mystery-of-zero</id><content type="html" xml:base="https://ziumper.github.io/blog/2025/Floats-and-mystery-of-zero/"><![CDATA[<p>Tak, serio. <code class="language-plaintext highlighter-rouge">-0.0</code> i <code class="language-plaintext highlighter-rouge">0.0</code> to dwie rÃ³Å¼ne reprezentacje bajtowe w standardzie <a href="https://pl.wikipedia.org/wiki/IEEE_754">IEEE 754</a> â€“ ale w praktyceâ€¦ PHP i tak je traktuje tak samo.</p> <p>MiaÅ‚em taki kod:</p> <div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">public</span> <span class="k">function</span> <span class="n">getPercentage</span><span class="p">():</span> <span class="kt">int</span>
<span class="p">{</span>
    <span class="c1">// epsilon to avoid division by zero</span>
    <span class="k">if</span> <span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="n">limitPrice</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="n">e</span><span class="o">-</span><span class="mi">8</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="nb">min</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="p">(</span><span class="n">int</span><span class="p">)</span> <span class="nb">round</span><span class="p">((</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="n">totalCartPrice</span> <span class="o">/</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="n">limitPrice</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span><span class="p">));</span>
<span class="p">}</span>
</code></pre></div></div> <p>I zaczÄ…Å‚em siÄ™ zastanawiaÄ‡:</p> <ul> <li>Czy mogÄ™ po prostu porÃ³wnaÄ‡ <code class="language-plaintext highlighter-rouge">$this-&gt;limitPrice == 0.0</code>?</li> <li>A co jeÅ›li <code class="language-plaintext highlighter-rouge">limitPrice</code> = <code class="language-plaintext highlighter-rouge">-0.0</code>? ğŸ¤¯</li> </ul> <hr/> <h2 id="-analiza">ğŸ”¬ Analiza</h2> <h3 id="1ï¸âƒ£-ieee-754-i--00">1ï¸âƒ£ IEEE 754 i -0.0</h3> <p>W standardzie liczb zmiennoprzecinkowych istnieje <strong>dodatnie zero (0.0)</strong> i <strong>ujemne zero (-0.0)</strong>.<br/> Na poziomie bajtÃ³w to dwie rÃ³Å¼ne wartoÅ›ci:</p> <ul> <li><code class="language-plaintext highlighter-rouge">0.0</code> â†’ <code class="language-plaintext highlighter-rouge">0x0000000000000000</code></li> <li><code class="language-plaintext highlighter-rouge">-0.0</code> â†’ <code class="language-plaintext highlighter-rouge">0x8000000000000000</code></li> </ul> <p>Czyli tak, binarnie to nie to samo.</p> <hr/> <h3 id="2ï¸âƒ£-co-na-to-php">2ï¸âƒ£ Co na to PHP?</h3> <p>PorÃ³wnajmy:</p> <div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">var_dump</span><span class="p">(</span><span class="mf">0.0</span> <span class="o">==</span> <span class="o">-</span><span class="mf">0.0</span><span class="p">);</span>   <span class="c1">// true</span>
<span class="nb">var_dump</span><span class="p">(</span><span class="mf">0.0</span> <span class="o">===</span> <span class="o">-</span><span class="mf">0.0</span><span class="p">);</span>  <span class="c1">// true</span>
</code></pre></div></div> <p>âœ… PHP traktuje te dwie wartoÅ›ci jako rÃ³wne zarÃ³wno w porÃ³wnaniu luÅºnym (<code class="language-plaintext highlighter-rouge">==</code>), jak i Å›cisÅ‚ym (<code class="language-plaintext highlighter-rouge">===</code>).</p> <p>Ale uwaga:</p> <div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">var_dump</span><span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="mf">0.0</span><span class="p">);</span>  <span class="c1">// float(INF)</span>
<span class="nb">var_dump</span><span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="o">-</span><span class="mf">0.0</span><span class="p">);</span> <span class="c1">// float(-INF)</span>
</code></pre></div></div> <p>â¡ï¸ Przy dzieleniu widaÄ‡ rÃ³Å¼nicÄ™ â€“ znak zera wpÅ‚ywa na wynik (<code class="language-plaintext highlighter-rouge">+âˆ</code> vs <code class="language-plaintext highlighter-rouge">-âˆ</code>).</p> <hr/> <h3 id="3ï¸âƒ£-czy-to-ma-znaczenie-w-moim-przypadku">3ï¸âƒ£ Czy to ma znaczenie w moim przypadku?</h3> <p>W moim kodzie <code class="language-plaintext highlighter-rouge">limitPrice</code> ma <strong>maksymalnie 4 miejsca po przecinku</strong>, pochodzi z bazy danych lub prostych operacji.<br/> Nie mam tu ujemnych zer z kosmosu.<br/> W praktyce mogÄ™ spokojnie napisaÄ‡:</p> <div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">if</span> <span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="n">limitPrice</span> <span class="o">==</span> <span class="mf">0.0</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div> <p>I wszystko dziaÅ‚a jak naleÅ¼y.<br/> Epsilon (<code class="language-plaintext highlighter-rouge">1e-8</code>) nie jest potrzebny, bo nie mam problemÃ³w z bÅ‚Ä™dami zaokrÄ…gleÅ„ na poziomie 17 miejsc po przecinku.</p> <hr/> <h2 id="-bonus-jak-wykryÄ‡--00-dla-nerdÃ³w">ğŸ›  Bonus: Jak wykryÄ‡ -0.0 (dla nerdÃ³w)</h2> <p>JeÅ¼eli jednak z jakiegoÅ› powodu <strong>musisz wiedzieÄ‡, czy to -0.0</strong>, oto trik:</p> <div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">function</span> <span class="n">isNegativeZero</span><span class="p">(</span><span class="kt">float</span> <span class="nv">$x</span><span class="p">):</span> <span class="kt">bool</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nv">$x</span> <span class="o">===</span> <span class="mf">0.0</span> <span class="o">&amp;&amp;</span> <span class="mi">1</span> <span class="o">/</span> <span class="nv">$x</span> <span class="o">===</span> <span class="o">-</span><span class="no">INF</span><span class="p">;</span>
<span class="p">}</span>

<span class="nb">var_dump</span><span class="p">(</span><span class="nf">isNegativeZero</span><span class="p">(</span><span class="mf">0.0</span><span class="p">));</span>  <span class="c1">// false</span>
<span class="nb">var_dump</span><span class="p">(</span><span class="nf">isNegativeZero</span><span class="p">(</span><span class="o">-</span><span class="mf">0.0</span><span class="p">));</span> <span class="c1">// true</span>
</code></pre></div></div> <p>Tak, trzeba podzieliÄ‡ przez zero, Å¼eby to wykryÄ‡. ğŸ§ª</p> <hr/> <h2 id="-wniosek">âœ… Wniosek</h2> <ul> <li>Tak, -0.0 i 0.0 to rÃ³Å¼ne bajty.</li> <li>PHP traktuje je jako rÃ³wne (<code class="language-plaintext highlighter-rouge">==</code>, <code class="language-plaintext highlighter-rouge">===</code>).</li> <li>MoÅ¼esz Å›miaÅ‚o pisaÄ‡ <code class="language-plaintext highlighter-rouge">== 0.0</code> w porÃ³wnaniach.</li> <li>Jedynie dzielenie przez 0.0 i -0.0 zwraca rÃ³Å¼ne nieskoÅ„czonoÅ›ci (INF vs -INF) â€“ wiÄ™c jak dzielisz, warto uÅ¼ywaÄ‡ <code class="language-plaintext highlighter-rouge">abs()</code>.</li> </ul> <hr/> <h2 id="-podsumowanie">ğŸ‰ Podsumowanie</h2> <p>UdaÅ‚o mi siÄ™ uproÅ›ciÄ‡ kod i <strong>zamiast epsilonÃ³w</strong> mam po prostu:</p> <div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">public</span> <span class="k">function</span> <span class="n">getPercentage</span><span class="p">():</span> <span class="kt">int</span>
<span class="p">{</span>
    <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="n">limitPrice</span> <span class="o">?</span> <span class="nb">min</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="p">(</span><span class="n">int</span><span class="p">)</span> <span class="nb">round</span><span class="p">((</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="n">totalCartPrice</span> <span class="o">/</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="n">limitPrice</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span><span class="p">))</span> <span class="o">:</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div> <p>Czytelniej, proÅ›ciej i dalej bezpiecznie.<br/> A fakt, Å¼e -0.0 istnieje, zostawiam jako ciekawostkÄ™ do impressowania znajomych programistÃ³w na kawie. â˜•ï¸ğŸ˜</p> <p>PS: JeÅ¼eli zaleÅ¼y Ci na uÅ¼yciu epislona to chyba znacznie lepiej uÅ¼yÄ‡ tej staÅ‚ej.</p> <div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kc">PHP_FLOAT_EPSILON</span>
</code></pre></div></div>]]></content><author><name></name></author><category term="php"/><summary type="html"><![CDATA[Czy wiesz, Å¼e w PHP istnieje ujemne zero? Ten post to podrÃ³Å¼ przez Å›wiat ujemnych zer, dzielenia przez nieskoÅ„czonoÅ›Ä‡ i tego, czemu w Twoim kodzie i tak moÅ¼esz spokojnie pisaÄ‡ == 0.0.]]></summary></entry><entry><title type="html">PhpUnit willReturnMap - PrzeglÄ…d PHP #4</title><link href="https://ziumper.github.io/pl/blog/2025/PHPUnit-will-return-map-trap/" rel="alternate" type="text/html" title="PhpUnit willReturnMap - PrzeglÄ…d PHP #4"/><published>2025-09-17T00:00:00+00:00</published><updated>2025-09-17T00:00:00+00:00</updated><id>https://ziumper.github.io/blog/2025/PHPUnit-will-return-map-trap</id><content type="html" xml:base="https://ziumper.github.io/blog/2025/PHPUnit-will-return-map-trap/"><![CDATA[<p>Historia o tym, jak przez jeden maÅ‚y <code class="language-plaintext highlighter-rouge">null</code> straciÅ‚em 30 minut Å¼ycia na debugowanie testÃ³w,<br/> a potem znalazÅ‚em prawdÄ™ w dokumentacjiâ€¦ ktÃ³ra milczy na ten temat. ğŸ™ƒ</p> <hr/> <h2 id="-problem">ğŸ§ Problem</h2> <p>ZaÅ‚Ã³Å¼my, Å¼e mamy takÄ… metodÄ™:</p> <div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">class</span> <span class="nc">MyService</span> <span class="p">{</span>
    <span class="k">public</span> <span class="k">function</span> <span class="n">doStuff</span><span class="p">(</span><span class="kt">string</span> <span class="nv">$key</span><span class="p">,</span> <span class="kt">?string</span> <span class="nv">$flag</span> <span class="o">=</span> <span class="kc">null</span><span class="p">):</span> <span class="kt">string</span> <span class="p">{</span>
        <span class="k">return</span> <span class="s2">"Result: "</span> <span class="mf">.</span> <span class="nv">$key</span> <span class="mf">.</span> <span class="p">(</span><span class="nv">$flag</span> <span class="o">?</span> <span class="s2">" (</span><span class="nv">$flag</span><span class="s2">)"</span> <span class="o">:</span> <span class="s2">""</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div> <p>I chcemy przetestowaÄ‡ klasÄ™, ktÃ³ra uÅ¼ywa <code class="language-plaintext highlighter-rouge">MyService</code> â€“ oczywiÅ›cie z mockiem.<br/> UÅ¼ywamy <strong><code class="language-plaintext highlighter-rouge">willReturnMap</code></strong>, bo jest eleganckie i dziaÅ‚a dla wielu zestawÃ³w argumentÃ³w.</p> <p>Brzmi prosto?<br/> No to spÃ³jrzmy na test:</p> <div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$mock</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="nf">createMock</span><span class="p">(</span><span class="nc">MyService</span><span class="o">::</span><span class="n">class</span><span class="p">);</span>

<span class="nv">$mock</span><span class="o">-&gt;</span><span class="nf">method</span><span class="p">(</span><span class="s1">'doStuff'</span><span class="p">)</span>
    <span class="o">-&gt;</span><span class="nf">willReturnMap</span><span class="p">([</span>
        <span class="p">[</span><span class="s1">'foo'</span><span class="p">,</span> <span class="s1">'Result: foo (bar)'</span><span class="p">],</span>
        <span class="p">[</span><span class="s1">'baz'</span><span class="p">,</span> <span class="s1">'Result: baz'</span><span class="p">],</span>
    <span class="p">]);</span>
</code></pre></div></div> <p>Brzmi dobrze, nie?<br/> <strong>NIE.</strong> ğŸ˜…</p> <hr/> <h2 id="-co-siÄ™-dzieje">ğŸ’¥ Co siÄ™ dzieje?</h2> <p>JeÅ›li nie przekaÅ¼esz dokÅ‚adnie tylu argumentÃ³w, ile metoda przyjmuje, PHPUnit powie:</p> <blockquote> <p>â€œNie wiem o co ci chodziâ€ ğŸ¤·â€â™‚ï¸<br/> i zwrÃ³ci <code class="language-plaintext highlighter-rouge">null</code>.</p> </blockquote> <p>Czyli gdy w kodzie produkcyjnym wywoÅ‚asz:</p> <div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$service</span><span class="o">-&gt;</span><span class="nf">doStuff</span><span class="p">(</span><span class="s1">'baz'</span><span class="p">);</span>
</code></pre></div></div> <p>to mock powie:</p> <blockquote> <p>â€œPrzykro mi, ale ja nie znam takiej mapyâ€.</p> </blockquote> <p>I test wybucha. ğŸ’£</p> <hr/> <h2 id="-dlaczego-tak-jest">ğŸ¤¯ Dlaczego tak jest?</h2> <p>Bo <code class="language-plaintext highlighter-rouge">willReturnMap</code> dopasowuje argumenty <strong>po kolei</strong>, 1:1.<br/> DomyÅ›lny argument <code class="language-plaintext highlighter-rouge">null</code> nie jest w magiczny sposÃ³b â€œzgadywanyâ€.<br/> Trzeba go tam podaÄ‡ jawnie w tablicy.</p> <hr/> <h2 id="-poprawne-rozwiÄ…zanie">âœ… Poprawne rozwiÄ…zanie</h2> <p>Trzeba <strong>dopasowaÄ‡ dokÅ‚adnie liczbÄ™ argumentÃ³w</strong>, nawet jeÅ›li sÄ… domyÅ›lne:</p> <div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$mock</span><span class="o">-&gt;</span><span class="nf">method</span><span class="p">(</span><span class="s1">'doStuff'</span><span class="p">)</span>
    <span class="o">-&gt;</span><span class="nf">willReturnMap</span><span class="p">([</span>
        <span class="p">[</span><span class="s1">'foo'</span><span class="p">,</span> <span class="s1">'bar'</span><span class="p">,</span> <span class="s1">'Result: foo (bar)'</span><span class="p">],</span>
        <span class="p">[</span><span class="s1">'baz'</span><span class="p">,</span> <span class="kc">null</span><span class="p">,</span> <span class="s1">'Result: baz'</span><span class="p">],</span> <span class="c1">// &lt;--- null musi byÄ‡!</span>
    <span class="p">]);</span>
</code></pre></div></div> <p>Tak, wiem â€“ niby oczywiste, ale jednak czÅ‚owiek czasem liczy na trochÄ™ magii. ğŸª„<br/> Niestety â€“ PHPUnit tutaj magii nie oferuje.</p> <hr/> <h2 id="-moraÅ‚-historii">ğŸ“ MoraÅ‚ historii</h2> <ul> <li><code class="language-plaintext highlighter-rouge">willReturnMap</code> jest super, ale jest <strong>bardzo dosÅ‚owne</strong>.</li> <li>JeÅ›li metoda ma 2 argumenty â€“ w mapie teÅ¼ musisz mieÄ‡ 2 argumenty.</li> <li>Nawet jeÅ›li ten drugi argument ma <code class="language-plaintext highlighter-rouge">null</code> jako default.</li> <li>PHPUnit nie robi za wrÃ³Å¼kÄ™ â€“ nie zgadnie, Å¼e miaÅ‚eÅ› na myÅ›li default. ğŸ˜…</li> </ul> <hr/> <h2 id="-wnioski">ğŸ‰ Wnioski</h2> <p>Po tym odkryciu moje testy przestaÅ‚y eksplodowaÄ‡.<br/> Wiedza, Å¼e <strong>trzeba jawnie podaÄ‡ kaÅ¼dy argument w mapie</strong>, oszczÄ™dziÅ‚a mi godzin debugowania.<br/> Teraz juÅ¼ wiem â€“ przy mockach <strong>lepiej podaÄ‡ o jeden argument za duÅ¼o niÅ¼ za maÅ‚o</strong>.</p> <blockquote> <p>ğŸ§  <strong>Meritum:</strong> <code class="language-plaintext highlighter-rouge">willReturnMap</code> â‰  elastyczne dopasowanie.<br/> To <strong>twarda mapa argumentÃ³w</strong> â€“ podaj wszystko albo nie narzekaj, Å¼e testy pÅ‚onÄ…. ğŸ”¥</p> </blockquote> <hr/> <p>âœï¸ <strong>PS:</strong> JeÅ›li ktoÅ› znajdzie w dokumentacji PHPUnit wzmiankÄ™ o tym case â€“ dajcie znaÄ‡.<br/> Ja nie znalazÅ‚em, a przeszukaÅ‚em pÃ³Å‚ internetu. ğŸ™ˆ</p> <p><a href="https://docs.phpunit.de/en/12.3/test-doubles.html#willreturnmap">Link do dokumentacji</a></p>]]></content><author><name></name></author><category term="php"/><summary type="html"><![CDATA[ğŸ› "PhpUnit, willReturnMap i domyÅ›lne argumenty â€“ czyli jak wpaÅ›Ä‡ w subtelnÄ… puÅ‚apkÄ™ ğŸª¤"]]></summary></entry><entry><title type="html">BackedEnum - PrzeglÄ…d PHP #3</title><link href="https://ziumper.github.io/pl/blog/2025/PHP-Backed-enums/" rel="alternate" type="text/html" title="BackedEnum - PrzeglÄ…d PHP #3"/><published>2025-09-16T00:00:00+00:00</published><updated>2025-09-16T00:00:00+00:00</updated><id>https://ziumper.github.io/blog/2025/PHP-Backed-enums</id><content type="html" xml:base="https://ziumper.github.io/blog/2025/PHP-Backed-enums/"><![CDATA[<p>Historia pewnego developera, ktÃ³ry postanowiÅ‚ poÅ¼egnaÄ‡ siÄ™ z niekoÅ„czÄ…cymi siÄ™ <code class="language-plaintext highlighter-rouge">const</code> i tablicami mapperÃ³w.<br/> Przy okazji dowiesz siÄ™, czym sÄ… <code class="language-plaintext highlighter-rouge">BackedEnums</code>, jakie majÄ… plusy i minusy, i czemu czasem lepiej siÄ™gnÄ…Ä‡ po <code class="language-plaintext highlighter-rouge">enum-name</code> niÅ¼ powielaÄ‡ wartoÅ›ci stringÃ³w.</p> <h2 id="-co-to-w-ogÃ³le-sÄ…-te-backedenums">ğŸ¤” Co to w ogÃ³le sÄ… te BackedEnums?</h2> <p>Od PHP <strong>8.1</strong> dostaliÅ›my wreszcie coÅ›, na co czekaliÅ›my od lat â€“ <strong>enumy</strong>!<br/> A do tego mamy ich bardziej wypasionÄ… wersjÄ™ â€“ <strong>BackedEnums</strong>.<br/> SÄ… to takie enumy, ktÃ³re oprÃ³cz nazwy mogÄ… mieÄ‡ jeszcze wartoÅ›Ä‡ (<code class="language-plaintext highlighter-rouge">string</code> albo <code class="language-plaintext highlighter-rouge">int</code>).<br/> Brzmi jak <code class="language-plaintext highlighter-rouge">const</code> w klasie, ale jest o niebo lepsze. ğŸ’ª</p> <h3 id="przykÅ‚ad-w-akcji">PrzykÅ‚ad w akcji</h3> <div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code> <span class="n">enum</span> <span class="nc">Status</span><span class="o">:</span> <span class="n">string</span> <span class="p">{</span>
     <span class="k">case</span> <span class="k">NEW</span> <span class="o">=</span> <span class="s1">'new'</span><span class="p">;</span>
     <span class="k">case</span> <span class="no">IN_PROGRESS</span> <span class="o">=</span> <span class="s1">'in_progress'</span><span class="p">;</span>
     <span class="k">case</span> <span class="no">DONE</span> <span class="o">=</span> <span class="s1">'done'</span><span class="p">;</span>
 <span class="p">}</span>

 <span class="c1">// UÅ¼ycie</span>
 <span class="nv">$orderStatus</span> <span class="o">=</span> <span class="nc">Status</span><span class="o">::</span><span class="k">NEW</span><span class="p">;</span>
 <span class="k">echo</span> <span class="nv">$orderStatus</span><span class="o">-</span><span class="n">value</span><span class="p">;</span> <span class="c1">// "new"</span>
 <span class="k">echo</span> <span class="nv">$orderStatus</span><span class="o">-</span><span class="n">name</span><span class="p">;</span>  <span class="c1">// "NEW"</span>
</code></pre></div></div> <hr/> <h2 id="-a-po-co-mi-to">ğŸ§ A po co mi to?</h2> <h3 id="zalety">Zalety:</h3> <ul> <li>âœ… <strong>CzytelnoÅ›Ä‡</strong> â€“ koniec z magicznymi stringami i zgadywaniem, co autor miaÅ‚ na myÅ›li.</li> <li>âœ… <strong>BezpieczeÅ„stwo typÃ³w</strong> â€“ nie wciÅ›niesz do funkcji <code class="language-plaintext highlighter-rouge">"N3W"</code> zamiast <code class="language-plaintext highlighter-rouge">"NEW"</code>.</li> <li>âœ… <strong>ÅatwoÅ›Ä‡ refaktoryzacji</strong> â€“ zmieniasz wartoÅ›Ä‡ w jednym miejscu i gotowe.</li> <li>âœ… <strong>Metody pomocnicze</strong> â€“ moÅ¼esz wrzucaÄ‡ do enumÃ³w logikÄ™ (np. <code class="language-plaintext highlighter-rouge">isFinished()</code>).</li> </ul> <h3 id="wady">Wady:</h3> <ul> <li>âŒ <strong>Tylko w PHP 8.1+</strong> â€“ jeÅ›li utknÄ…Å‚eÅ› na 7.4, to pozostaje ci tylko pÅ‚akaÄ‡ w kÄ…cie.</li> <li>âŒ <strong>TrochÄ™ magii</strong> â€“ przy duÅ¼ych projektach musisz dobrze przemyÅ›leÄ‡, czy uÅ¼ywaÄ‡ <code class="language-plaintext highlighter-rouge">value</code> czy <code class="language-plaintext highlighter-rouge">name</code>.</li> <li>âŒ <strong>Overkill dla prostych przypadkÃ³w</strong> â€“ jak masz 2 wartoÅ›ci na krzyÅ¼, to moÅ¼e wystarczyÄ‡ <code class="language-plaintext highlighter-rouge">const</code>.</li> </ul> <hr/> <h2 id="-dlaczego-backedenums-dla-stringÃ³w-mogÄ…-byÄ‡-kÅ‚opotliwe">ğŸ˜… Dlaczego <code class="language-plaintext highlighter-rouge">BackedEnums</code> dla stringÃ³w mogÄ… byÄ‡ kÅ‚opotliwe?</h2> <p>No wÅ‚aÅ›nie, tutaj miaÅ‚em maÅ‚Ä… zagwozdkÄ™.<br/> JeÅ¼eli <strong>wartoÅ›Ä‡ enuma = jego nazwa</strong>, to trochÄ™ strzelamy sobie w kolano, bo potem w kodzie mamy:</p> <div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code> <span class="nc">Status</span><span class="o">::</span><span class="k">NEW</span><span class="o">-</span><span class="n">value</span> <span class="c1">// "NEW"</span>
 <span class="nc">Status</span><span class="o">::</span><span class="k">NEW</span><span class="o">-</span><span class="n">name</span>  <span class="c1">// "NEW"</span>
</code></pre></div></div> <p>A skoro moÅ¼na po prostu uÅ¼ywaÄ‡ <code class="language-plaintext highlighter-rouge">-name</code>, to po co nam to caÅ‚e <code class="language-plaintext highlighter-rouge">value</code>?<br/> Zamiast tego lepiej zostawiÄ‡ zwykÅ‚e <code class="language-plaintext highlighter-rouge">enum</code> (bez wartoÅ›ci) i mieÄ‡ spokÃ³j.</p> <h2 id="-a-co-byÅ‚o-przed-enumami">â³ A co byÅ‚o przed enumami?</h2> <p>Ach, stare dobre czasyâ€¦<br/> PisaliÅ›my takie kwiatki:</p> <div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">class</span> <span class="nc">Status</span> <span class="p">{</span>
    <span class="k">public</span> <span class="k">const</span> <span class="no">NEW</span> <span class="o">=</span> <span class="s1">'new'</span><span class="p">;</span>
    <span class="k">public</span> <span class="k">const</span> <span class="no">IN_PROGRESS</span> <span class="o">=</span> <span class="s1">'in_progress'</span><span class="p">;</span>
    <span class="k">public</span> <span class="k">const</span> <span class="no">DONE</span> <span class="o">=</span> <span class="s1">'done'</span><span class="p">;</span>
<span class="p">}</span>

<span class="nv">$status</span> <span class="o">=</span> <span class="nc">Status</span><span class="o">::</span><span class="k">NEW</span><span class="p">;</span>
</code></pre></div></div> <p>Albo jeszcze lepiej â€“ <strong>tablice mapperÃ³w</strong>, ktÃ³re trzeba byÅ‚o utrzymywaÄ‡ w 3 miejscach naraz.<br/> (Tak, wszyscy wiemy, Å¼e to bolaÅ‚o).</p> <hr/> <h2 id="-before--after--czyli-jak-siÄ™-pozbyÅ‚em-mapperÃ³w">ğŸ”„ Before &amp; After â€“ czyli jak siÄ™ pozbyÅ‚em mapperÃ³w</h2> <p><strong>Przed (mappery):</strong></p> <div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">class</span> <span class="nc">OrderStatus</span> <span class="p">{</span>
   <span class="k">public</span> <span class="k">const</span> <span class="no">NEW</span> <span class="o">=</span> <span class="s1">'new'</span><span class="p">;</span>
   <span class="k">public</span> <span class="k">const</span> <span class="no">IN_PROGRESS</span> <span class="o">=</span> <span class="s1">'in_progress'</span><span class="p">;</span>
   <span class="k">public</span> <span class="k">const</span> <span class="no">DONE</span> <span class="o">=</span> <span class="s1">'done'</span><span class="p">;</span>

    <span class="k">public</span> <span class="k">static</span> <span class="kt">array</span> <span class="nv">$labels</span> <span class="o">=</span> <span class="p">[</span>
        <span class="k">self</span><span class="o">::</span><span class="k">NEW</span> <span class="o">=</span> <span class="s2">"I'm doing things now!"</span><span class="p">,</span>
        <span class="k">self</span><span class="o">::</span><span class="no">IN_PROGRESS</span> <span class="o">=</span> <span class="s2">"I'm working on it!"</span><span class="p">,</span>
        <span class="k">self</span><span class="o">::</span><span class="no">DONE</span> <span class="o">=</span> <span class="s2">"I finished"</span><span class="p">,</span>
    <span class="p">];</span>
<span class="p">}</span>

<span class="k">echo</span> <span class="nc">OrderStatus</span><span class="o">::</span><span class="nv">$labels</span><span class="p">[</span><span class="nc">OrderStatus</span><span class="o">::</span><span class="no">IN_PROGRESS</span><span class="p">];</span> <span class="c1">// "I'm working on it!"</span>
</code></pre></div></div> <p><strong>Po (enumy):</strong></p> <div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">enum</span> <span class="nc">OrderStatus</span><span class="o">:</span> <span class="n">string</span> <span class="p">{</span>
    <span class="k">case</span> <span class="k">NEW</span> <span class="o">=</span> <span class="s1">'new'</span><span class="p">;</span>
    <span class="k">case</span> <span class="no">IN_PROGRESS</span> <span class="o">=</span> <span class="s1">'in_progress'</span><span class="p">;</span>
    <span class="k">case</span> <span class="no">DONE</span> <span class="o">=</span> <span class="s1">'done'</span><span class="p">;</span>

    <span class="k">public</span> <span class="k">function</span> <span class="n">label</span><span class="p">():</span> <span class="kt">string</span> <span class="p">{</span>
        <span class="k">return</span> <span class="k">match</span><span class="p">(</span><span class="nv">$this</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">self</span><span class="o">::</span><span class="k">NEW</span> <span class="o">=</span> <span class="s2">"I'm doing things now!"</span><span class="p">,,</span>
            <span class="k">self</span><span class="o">::</span><span class="no">IN_PROGRESS</span> <span class="o">=</span> <span class="s2">"I'm working on it!"</span><span class="p">,</span>
            <span class="k">self</span><span class="o">::</span><span class="no">DONE</span> <span class="o">=</span> <span class="s2">"I finished"</span><span class="p">,</span>
        <span class="p">};</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="k">echo</span> <span class="nc">OrderStatus</span><span class="o">::</span><span class="no">IN_PROGRESS</span><span class="o">-&gt;</span><span class="nf">label</span><span class="p">();</span> <span class="c1">// "I'm working on it!"</span>
</code></pre></div></div> <p>Rezultat? Mappery out, kod jest czytelniejszy, a IDE podpowiada mi wszystko na bieÅ¼Ä…co. ğŸ˜<br/> PrzykÅ‚ad jest ciut abstrakcyjny, ale mimo wszystko oddaje problemy, z ktÃ³rymi naleÅ¼y sobie radziÄ‡.</p> <hr/> <h2 id="-moja-maÅ‚a-rewolucja">ğŸ‰ Moja maÅ‚a rewolucja</h2> <p>DziÄ™ki enumom udaÅ‚o mi siÄ™ pozbyÄ‡ caÅ‚ych mapperÃ³w wartoÅ›ci!<br/> Teraz kod jest czytelniejszy, IDE podpowiada mi wartoÅ›ci, a ja Å›piÄ™ spokojnie. ğŸ›Œ</p> <p>Mappery? <strong>Nie, dziÄ™kujÄ™.</strong><br/> Enumy przejÄ™Å‚y paÅ‚eczkÄ™ i zrobiÅ‚y to lepiej.<br/> I serio â€“ warto byÅ‚o to zrobiÄ‡. ğŸ˜</p> <hr/> <h2 id="-podsumowanie">ğŸ“Œ Podsumowanie</h2> <ul> <li>PHP 8.1 daÅ‚o nam <strong>enumy</strong> i <strong>BackedEnums</strong>.</li> <li>UÅ¼ywaj BackedEnums, gdy potrzebujesz <em>mapowania</em> nazw na wartoÅ›ci (<code class="language-plaintext highlighter-rouge">int</code>, <code class="language-plaintext highlighter-rouge">string</code>).</li> <li>Gdy <code class="language-plaintext highlighter-rouge">value == name</code> â€“ rozwaÅ¼ zwykÅ‚e <code class="language-plaintext highlighter-rouge">enum</code>.</li> <li>Enumy = mniej bugÃ³w, mniej mapperÃ³w, wiÄ™cej spokoju w duszy.</li> </ul> <p><strong>MoraÅ‚:</strong> Enumy to takie nowe <code class="language-plaintext highlighter-rouge">consty</code>, tylko Å‚adniejsze i mÄ…drzejsze.<br/> Mappery moÅ¼esz teraz wysÅ‚aÄ‡ na emeryturÄ™. ğŸ–ï¸</p> <hr/> <p>âœï¸ <strong>PS:</strong> Tak, uÅ›miechaÅ‚em siÄ™, piszÄ…c ten post. Bo naprawdÄ™ cieszÄ™ siÄ™, Å¼e w koÅ„cu mamy porzÄ…dne enumy w PHP. â¤ï¸</p>]]></content><author><name></name></author><category term="php"/><summary type="html"><![CDATA[ğŸ† BackedEnums w PHP â€“ czyli jak skoÅ„czyÅ‚em z mapperami i pokochaÅ‚em enumy â¤ï¸]]></summary></entry><entry><title type="html">Funkcje tablicowe: inicjalizacja tablicy przy pomocy [â€¦] lub array()? - PrzeglÄ…d PHP #2</title><link href="https://ziumper.github.io/pl/blog/2025/PHP-array-or-brackets/" rel="alternate" type="text/html" title="Funkcje tablicowe: inicjalizacja tablicy przy pomocy [â€¦] lub array()? - PrzeglÄ…d PHP #2"/><published>2025-03-24T00:00:00+00:00</published><updated>2025-03-24T00:00:00+00:00</updated><id>https://ziumper.github.io/blog/2025/PHP-array-or-brackets</id><content type="html" xml:base="https://ziumper.github.io/blog/2025/PHP-array-or-brackets/"><![CDATA[<p>Jest to kolejna seria z cyklu PHP review. Tym razem postanowÅ‚em przyjrzeÄ‡ siÄ™ trochÄ™ bliÅ¼ej funkcji deklarujÄ…cej array i co siÄ™ za niÄ… tak naprawdÄ™ kryje. Z tego co pamiÄ™tam zapis <code class="language-plaintext highlighter-rouge">array()</code> przez moich kolegÃ³w z pracy uznawany byÅ‚ za zaÅ¼yÅ‚oÅ›Ä‡ i nie powinno siÄ™ juÅ¼ go uÅ¼ywaÄ‡. Aby siÄ™ o tym przekonaÄ‡ postanowiÅ‚em zaciÄ…gnÄ…Ä‡ repozytorium frameworka do refaktoryzacji i aktualizacji kodu PHP, czyli Rectora. No, bo jakie narzÄ™dzie najlepiej operuje na tablicach jak nie narzÄ™dzie do jego refaktoryzacji i bÄ™dzie trzymaÄ‡ siÄ™ najlepszych praktyk tworzenia i pisania kodu?</p> <h2 id="kolejne-gÅ‚Ä™bokie-zanurzenie-w-pÅ‚ycizne">Kolejne gÅ‚Ä™bokie zanurzenie w pÅ‚ycizne</h2> <p>Ku mojemu zdziwieniu nie znalazÅ‚em zbyt duÅ¼o przykÅ‚adÃ³w. Nawiasem mÃ³wiÄ…c jedynym przykÅ‚adem, ktÃ³ry rzeczywiÅ›cie zostaÅ‚a uÅ¼yta funkcja <code class="language-plaintext highlighter-rouge">array()</code> albo raczej jej dokumentacja, Å¼eby jej nie uÅ¼ywaÄ‡ :-). w frameworku Rector, byÅ‚a zÅ‚ota zasada dla <a href="https://github.com/rectorphp/rector/blob/59ca5ad3cdd75183ef65f6929693903f2f2a1717/rules/Php54/Rector/Array_/LongArrayToShortArrayRector.php#L30">LongArrayToShortArray</a></p> <div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">public</span> <span class="k">function</span> <span class="n">getRuleDefinition</span><span class="p">()</span> <span class="p">:</span> <span class="kt">RuleDefinition</span>
    <span class="p">{</span>
        <span class="k">return</span> <span class="k">new</span> <span class="nc">RuleDefinition</span><span class="p">(</span><span class="s1">'Long array to short array'</span><span class="p">,</span> <span class="p">[</span><span class="k">new</span> <span class="nc">CodeSample</span><span class="p">(</span><span class="sh">&lt;&lt;&lt;'CODE_SAMPLE'
class SomeClass
{
    public function run()
    {
        return array();
    }
}
CODE_SAMPLE</span>
<span class="p">,</span> <span class="sh">&lt;&lt;&lt;'CODE_SAMPLE'
class SomeClass
{
    public function run()
    {
        return [];
    }
}
CODE_SAMPLE</span>
<span class="p">)]);</span>
</code></pre></div></div> <p>To daje do myÅ›lenia. ZwaÅ¼ajÄ…c na to, Å¼e metoda klasy <code class="language-plaintext highlighter-rouge">LongArrayToShortArrayRector.php</code> zostaÅ‚a umieszczona w pakiecie <code class="language-plaintext highlighter-rouge">Php54</code>. W wersji <strong>PHP5.4</strong> zostaÅ‚ dodany krÃ³tki operator tablicowy. Od tamej pory poleca siÄ™ uÅ¼ywaÄ‡, krÃ³tszej wersji zapisu tablicy.</p> <p>To nadal nie odpowiada do koÅ„ca na pytanie, jaka jest zasadnicza rÃ³Å¼nica pomiÄ™dzy wywoÅ‚aniem <code class="language-plaintext highlighter-rouge">array()</code> a <code class="language-plaintext highlighter-rouge">[ ]</code>. A wiec co naprawdÄ™ dzieje siÄ™ za kulisami? W momencie odpaleniu skryptu PHP trzeba najpierw upiec placekâ€¦ aby upiec placek trzeba:</p> <figure> <iframe src="https://www.youtube.com/embed/oVSGrY4DfUg" class="rounded z-depth-1" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen="" width="100%" height="500px"></iframe> </figure> <h2 id="stworzyÄ‡-abstract-syntax-tree-czyli-placek">StworzyÄ‡ Abstract Syntax Tree, czyli placek</h2> <p>Tak naprawdÄ™ wystarczy zrozumieÄ‡ AST - Abstract Syntax Tree. Jest to struktura drzewiasta, ktÃ³ra jest konieczna, aby oddzieliÄ‡ proces kompilacji od parsera. <a href="https://en.wikipedia.org/wiki/Lexical_analysis">Lexer</a> zwraca tokeny, ktÃ³re pÃ³Åºniej sÄ… przetwarzane przez parser zwracajÄ…cy strukturÄ™ ast, ktÃ³ra pÃ³Åºniej przechodzi kompilacje i na Å›wiat przychodzi â€œplacekâ€ w postaci kodÃ³w opcode umieszczonych w opcache, a one pÃ³Åºniej mogÄ… zostaÄ‡ zrozumiane przez komputer jako ciÄ…g wykonywalnych instrukcji. Aby dowiedzieÄ‡ siÄ™ wiÄ™cej na ten temat polecam obejrzeÄ‡ poniÅ¼szy materiaÅ‚ video:</p> <blockquote> <p><a href="https://www.youtube.com/watch?v=MWITYIWyowk">Climbing the Abstract Syntax Tree - James Titcumb - Forum PHP 2017</a></p> </blockquote> <h2 id="no-dobra-gdzie-w-takim-razie-wystÄ™puje-rÃ³Å¼nica-pomiÄ™dzy--a-array">No dobra, gdzie w takim razie wystÄ™puje rÃ³Å¼nica pomiÄ™dzy <code class="language-plaintext highlighter-rouge">[]</code> a <code class="language-plaintext highlighter-rouge">array()</code>?</h2> <p>Pierwsza rÃ³Å¼nica, ktÃ³rÄ… zauwaÅ¼yÅ‚em byÅ‚a w <a href="https://github.com/php/php-src/blob/master/Zend/zend_compile.h#L1044">kompilatorze</a>. MoÅ¼na Å‚atwo zauwaÅ¼yÄ‡, Å¼e zapis zostaÅ‚ oddzielony na skÅ‚adniÄ… dÅ‚ugÄ… oraz krÃ³tkÄ….</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>#define ZEND_ARRAY_SYNTAX_LIST 1  /* list() */
#define ZEND_ARRAY_SYNTAX_LONG 2  /* array() */
#define ZEND_ARRAY_SYNTAX_SHORT 3 /* [] */
</code></pre></div></div> <p>oraz w przypadku walidacji przypisania</p> <div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">static</span> <span class="kt">void</span> <span class="nf">zend_verify_list_assign_target</span><span class="p">(</span><span class="n">zend_ast</span> <span class="o">*</span><span class="n">var_ast</span><span class="p">,</span> <span class="n">zend_ast_attr</span> <span class="n">array_style</span><span class="p">)</span> <span class="p">{</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">var_ast</span><span class="o">-&gt;</span><span class="n">kind</span> <span class="o">==</span> <span class="n">ZEND_AST_ARRAY</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">var_ast</span><span class="o">-&gt;</span><span class="n">attr</span> <span class="o">==</span> <span class="n">ZEND_ARRAY_SYNTAX_LONG</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">zend_error_noreturn</span><span class="p">(</span><span class="n">E_COMPILE_ERROR</span><span class="p">,</span> <span class="s">"Cannot assign to array(), use [] instead"</span><span class="p">);</span>
		<span class="p">}</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">array_style</span> <span class="o">!=</span> <span class="n">var_ast</span><span class="o">-&gt;</span><span class="n">attr</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">zend_error_noreturn</span><span class="p">(</span><span class="n">E_COMPILE_ERROR</span><span class="p">,</span> <span class="s">"Cannot mix [] and list()"</span><span class="p">);</span>
		<span class="p">}</span>
	<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">zend_can_write_to_variable</span><span class="p">(</span><span class="n">var_ast</span><span class="p">))</span> <span class="p">{</span>
		<span class="n">zend_error_noreturn</span><span class="p">(</span><span class="n">E_COMPILE_ERROR</span><span class="p">,</span> <span class="s">"Assignments can only happen to writable values"</span><span class="p">);</span>
	<span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div> <p>W kodzie php ma to nastÄ™pujÄ…ce konsekwencje:</p> <div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">array</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">];</span>  <span class="c1">// BÅ‚Ä…d: nie moÅ¼na przypisaÄ‡ do array()</span>
<span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">];</span>  <span class="c1">// Poprawne</span>
</code></pre></div></div> <p>Szczerze, nie spodziewaÅ‚em siÄ™ spotkaÄ‡ takich kruczkÃ³w w kompilatorze, ale jest to pewna znaczÄ…ca rÃ³Å¼nica.</p> <p>Kolejna rÃ³Å¼nica jest widoczna w tak zwanym <a href="https://en.wikipedia.org/wiki/Lexical_analysis">Lexerze</a>. w pliku <a href="https://github.com/php/php-src/blob/master/Zend/zend_language_scanner.l#L1764C1-L1766C2">language_scanner.l</a></p> <pre><code class="language-lexer">&lt;ST_IN_SCRIPTING&gt;"array" {
	RETURN_TOKEN_WITH_IDENT(T_ARRAY);
}

&lt;ST_IN_SCRIPTING&gt;"["|"(" {
	enter_nesting(yytext[0]);
	RETURN_TOKEN(yytext[0]);
}

&lt;ST_IN_SCRIPTING&gt;"]"|")" {
	/* Check that ] and ) match up properly with a preceding [ or ( */
	RETURN_EXIT_NESTING_TOKEN(yytext[0]);
}

</code></pre> <h2 id="jakie-wnioski-moÅ¼na-wysunÄ…Ä‡">Jakie wnioski moÅ¼na wysunÄ…Ä‡?</h2> <ul> <li>W przypadku <code class="language-plaintext highlighter-rouge">[]</code> lexer musi zwrÃ³ciÄ‡ dwa tokeny, a parser potem Å‚Ä…czy je w odpowiedniÄ… strukturÄ™. To wymaga wiÄ™cej pracy w fazie tokenizacji i parsowania w porÃ³wnaniu do <code class="language-plaintext highlighter-rouge">array()</code>, gdzie lexer zwraca gotowy token <code class="language-plaintext highlighter-rouge">T_ARRAY</code>, a parser tylko przetwarza go jako jedno wyraÅ¼enie. Musi wykonaÄ‡ dodatkowe kroki, aby sprawdziÄ‡, czy to tablica, analizujÄ…c dokÅ‚adniej. Zatem w przypadku <code class="language-plaintext highlighter-rouge">[]</code> parser musi dÅ‚uÅ¼ej analizowaÄ‡ kod. GdyÅ¼ zczytywanie struktur AST odbywa siÄ™ znak po znaku, w odwrÃ³conej <a href="https://en.wikipedia.org/wiki/Reverse_Polish_notation">notacji polskiej</a>.</li> <li>Wersja PHP bez opcache wymaga kaÅ¼dorazowego przetwarzania kodu w czasie wykonywania. Oznacza to, Å¼e kaÅ¼de wywoÅ‚anie kodu w PHP, zarÃ³wno array(), jak i [], wymaga zwrÃ³cenia siÄ™ do lexera i parsera w celu wygenerowania AST i opcodÃ³w.</li> <li>DÅ‚uÅ¼szy czas parsowania dla []: PoniewaÅ¼ [] wymaga dodatkowej analizy przez parsera (musi rozpoznaÄ‡ nawiasy), przetwarzanie zajmuje wiÄ™cej czasu.</li> <li>KrÃ³tszy czas dla array(): Token `T_ARRAY jest prostszy do rozpoznania i parser nie musi przeprowadzaÄ‡ dodatkowej analizy skÅ‚adniowej. Proces parsowania jest szybszy dla T_ARRAY, ale tylko, gdy nie uÅ¼ywa siÄ™ opcache.</li> </ul> <p>No i kto by pomyÅ›laÅ‚, Å¼eby okreÅ›liÄ‡, jaka jest prawdziwa rÃ³Å¼nica pomiÄ™dzy <code class="language-plaintext highlighter-rouge">[ ]</code> i <code class="language-plaintext highlighter-rouge">array()</code> bÄ™dÄ™ zmuszony wgÅ‚Ä™biÄ‡ siÄ™ aÅ¼ tak bardzo w php. Wydaje siÄ™, Å¼e nadal wywoÅ‚anie funkcji <code class="language-plaintext highlighter-rouge">array()</code> moÅ¼e mieÄ‡ pewne zastosowania.</p> <ul> <li>kiedy za kaÅ¼dym kompiluje siÄ™ kod bez dostÄ™pu do pamiÄ™ci tymczasowej opcache, co jest raczej rzadkoÅ›ciÄ….</li> <li>funkcja <code class="language-plaintext highlighter-rouge">eval()</code> w ktÃ³rej oppcache nie jest wykorzystywany.</li> </ul> <h2 id="waÅ¼ne-linki">WaÅ¼ne Linki</h2> <ul> <li><a href="https://github.com/php/php-src/tree/master">The PHP Interpreter</a></li> <li><a href="https://en.wikipedia.org/wiki/Abstract_syntax_tree">AST</a></li> <li><a href="https://www.php.net/manual/en/opcache.preloading.php">OpCache Preloading</a></li> </ul>]]></content><author><name></name></author><category term="php"/><summary type="html"><![CDATA[Czy deklarowanie tablicy za pomocÄ… sÅ‚owa array() idzie na Å›mietnik historii? Co ma wspÃ³lnego pieczenie placka z kompilacjÄ… kodu?]]></summary></entry></feed>